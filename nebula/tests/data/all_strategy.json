[
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "distinct orderid",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "order_id"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "0 paystatus",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "HOLDER",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "下单不支付"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503637233341,
    "score": 0,
    "category": "ORDER",
    "remark": ">4 in 30min no pay",
    "isLock": false,
    "name": "IP下单不支付",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503637233341
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "did",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "register_channel"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "register_channel"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "^\\s*$",
                "left": "register_channel",
                "op": "!regex"
              },
              {
                "right": "c_ip",
                "left": "c_ip",
                "op": "="
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "邀请注册"
    ],
    "app": "nebula",
    "starteffect": 1484042007770,
    "endeffect": 1609667608438,
    "modifytime": 1504493794161,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">3 register_count, 1 register_channel in 1h",
    "isLock": false,
    "name": "IP使用相同邀请码注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504493794161
  },
  {
    "status": "online",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "did",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__account_regist_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "register_channel"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "^\\s*$",
                "left": "register_channel",
                "op": "!regex"
              },
              {
                "right": "c_ip",
                "left": "c_ip",
                "op": "="
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "邀请注册"
    ],
    "app": "nebula",
    "starteffect": 1484042007770,
    "endeffect": 1609667608438,
    "modifytime": 1504494011629,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 register_count, same register_channel in 5m",
    "isLock": false,
    "name": "IP使用相同邀请码注册5m",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504494011629
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_distinct_count_uid__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频关联"
    ],
    "app": "nebula",
    "starteffect": 1484044813003,
    "endeffect": 1641120013785,
    "modifytime": 1503900505932,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 5m",
    "isLock": false,
    "name": "IP关联多个用户",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503900505932
  },
  {
    "status": "online",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_distinct_count_did__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频关联"
    ],
    "app": "nebula",
    "starteffect": 1484044813003,
    "endeffect": 1641120013785,
    "modifytime": 1503901279068,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 5m",
    "isLock": false,
    "name": "IP关联多个设备",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503901279068
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__account_login_distinct_count_uid__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503568146528,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5用户 in 5min",
    "isLock": false,
    "name": "IP关联多用户请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503568146528
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "did"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503568119087,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5设备 in 5min",
    "isLock": false,
    "name": "IP关联多设备请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503568119087
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "byte",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5242880"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "s_bytes",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "恶意扫描"
    ],
    "app": "nebula",
    "starteffect": 1477908654360,
    "endeffect": 1570183854490,
    "modifytime": 1503375172727,
    "score": 0,
    "category": "VISITOR",
    "remark": "> 5M",
    "isLock": false,
    "name": "IP响应字节过大",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503375172727
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1504174198108,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 uid in 10m",
    "isLock": false,
    "name": "IP多个用户请求注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504174198108
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "did"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1504174224401,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 did in 10m",
    "isLock": false,
    "name": "IP多个设备请求注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504174224401
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__account_regist_distinct_count_password__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__account_regist_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042523835,
    "endeffect": 1672480924640,
    "modifytime": 1503386404862,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">3, 1密码 in 5m",
    "isLock": false,
    "name": "IP多次使用相同密码注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503386404862
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_CANCEL"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_CANCEL"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_CANCEL"
              ]
            },
            "operand": [
              "order_id"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "取消订单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503634816782,
    "score": 0,
    "category": "ORDER",
    "remark": ">3 in 30min distinct orderid",
    "isLock": false,
    "name": "IP多次取消订单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503634816782
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "F"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "F",
                "op": "==",
                "left": "result"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1503386667613,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 5m",
    "isLock": false,
    "name": "IP多次注册失败",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503386667613
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "T"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "T",
                "op": "==",
                "left": "result"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1503386756408,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 5m",
    "isLock": false,
    "name": "IP多次注册成功",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503386756408
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "F"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "F",
                "op": "==",
                "left": "result"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503565039645,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 10min F",
    "isLock": false,
    "name": "IP多次登录失败",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503565039645
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "T"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "T",
                "op": "==",
                "left": "result"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503564916674,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 10min T",
    "isLock": false,
    "name": "IP多次登录成功",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503564916674
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503633821634,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 30min",
    "isLock": false,
    "name": "IP多次请求下单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503633821634
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "product_id"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504160214304,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, product_id",
    "isLock": false,
    "name": "IP多次请求下单__不同商品",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504160214304
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "merchant"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504160220254,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, merchant",
    "isLock": false,
    "name": "IP多次请求下单__不同商户",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504160220254
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_detail"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504160245099,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, receiver_address_detail",
    "isLock": false,
    "name": "IP多次请求下单__不同地址",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504160245099
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_city"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504160197939,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, receiver_address_city ",
    "isLock": false,
    "name": "IP多次请求下单__不同城市",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504160197939
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_mobile"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504160226047,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, receiver_mobile",
    "isLock": false,
    "name": "IP多次请求下单__不同手机号",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504160226047
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "user_name"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504160208838,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, user_name",
    "isLock": false,
    "name": "IP多次请求下单__不同收货人",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504160208838
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "order_money_amount"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504160236012,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, order_money_amount",
    "isLock": false,
    "name": "IP多次请求下单__不同金额",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504160236012
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "product_id"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504155104432,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, product_id",
    "isLock": false,
    "name": "IP多次请求下单__同一商品",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504155104432
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "merchant"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504155163196,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, merchant",
    "isLock": false,
    "name": "IP多次请求下单__同一商户",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504155163196
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_detail"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504168922629,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, receiver_address_detail",
    "isLock": false,
    "name": "IP多次请求下单__同一地址",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504168922629
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_city"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504154957939,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, receiver_address_city ",
    "isLock": false,
    "name": "IP多次请求下单__同一城市",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504154957939
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_mobile"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504158858195,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, receiver_mobile",
    "isLock": false,
    "name": "IP多次请求下单__同手机号",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504158858195
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "user_name"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504155055631,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, user_name",
    "isLock": false,
    "name": "IP多次请求下单__同收货人",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504155055631
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "金额",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "100"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "order_money_amount",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "次数",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "100",
                "op": "<=",
                "left": "order_money_amount"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504155231630,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, order_money_amount<= 100",
    "isLock": false,
    "name": "IP多次请求下单__金额较低",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504155231630
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "金额",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "100"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "order_money_amount",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "次数",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "100",
                "op": ">",
                "left": "order_money_amount"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159669567,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, order_money_amount > 100",
    "isLock": false,
    "name": "IP多次请求下单__金额较高",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159669567
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "10"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1503386187693,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">10 in 5m",
    "isLock": false,
    "name": "IP多次请求注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503386187693
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__account_login_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503564773589,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 5min",
    "isLock": false,
    "name": "IP多次请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503564773589
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503634303042,
    "score": 0,
    "category": "ORDER",
    "remark": ">3 用户 in 30min",
    "isLock": false,
    "name": "IP多用户请求下单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503634303042
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "did"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503634153224,
    "score": 0,
    "category": "ORDER",
    "remark": ">3 设备 in 30min",
    "isLock": false,
    "name": "IP多设备请求下单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503634153224
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "404"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "status",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "10"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "404",
                "op": "==",
                "left": "status"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "恶意扫描"
    ],
    "app": "nebula",
    "starteffect": 1484101084953,
    "endeffect": 1609553885794,
    "modifytime": 1503316238558,
    "score": 0,
    "category": "VISITOR",
    "remark": ">10 in 5m",
    "isLock": false,
    "name": "IP大量404返回",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503316238558
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "399"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "status",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<",
        "right": {
          "subtype": "",
          "config": {
            "value": "500"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "status",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!=",
        "right": {
          "subtype": "",
          "config": {
            "value": "404"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "status",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "10"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "399",
                "op": ">",
                "left": "status"
              },
              {
                "right": "500",
                "op": "<",
                "left": "status"
              },
              {
                "right": "404",
                "op": "!=",
                "left": "status"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "恶意扫描"
    ],
    "app": "nebula",
    "starteffect": 1484101084953,
    "endeffect": 1609553885794,
    "modifytime": 1503316303247,
    "score": 0,
    "category": "VISITOR",
    "remark": ">10 in 5m, 不包含404",
    "isLock": false,
    "name": "IP大量4XX返回",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503316303247
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "100"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484102219223,
    "endeffect": 1641091020091,
    "modifytime": 1503314912283,
    "score": 0,
    "category": "VISITOR",
    "remark": ">100 in 5m",
    "isLock": false,
    "name": "IP大量动态请求",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503314912283
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "300"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484102219223,
    "endeffect": 1641091020091,
    "modifytime": 1503316539874,
    "score": 0,
    "category": "VISITOR",
    "remark": ">300 in 5m 静态+动态",
    "isLock": false,
    "name": "IP大量访问",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503316539874
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "50"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_static_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484101981295,
    "endeffect": 1672540382000,
    "modifytime": 1503317182818,
    "score": 0,
    "category": "VISITOR",
    "remark": ">50 动态+静态, 0静态 in 5m",
    "isLock": false,
    "name": "IP大量请求不加载静态资源",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503317182818
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_clicks_count_refererhit__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "20"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一访问"
    ],
    "app": "nebula",
    "starteffect": 1484102481911,
    "endeffect": 1672540882527,
    "modifytime": 1503376045710,
    "score": 0,
    "category": "VISITOR",
    "remark": ">20, 0 referrer in 5m",
    "isLock": false,
    "name": "IP大量请求不带referrer",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503376045710
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "10"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_distinct_count_page__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一访问"
    ],
    "app": "nebula",
    "starteffect": 1484102336270,
    "endeffect": 1641091136886,
    "modifytime": 1503316836331,
    "score": 0,
    "category": "VISITOR",
    "remark": ">10 , 页面=1",
    "isLock": false,
    "name": "IP大量请求单个接口",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503316836331
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "register"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "register",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484102697103,
    "endeffect": 1672454699088,
    "modifytime": 1503317409061,
    "score": 0,
    "category": "VISITOR",
    "remark": ">5 in 5m 不需要解析 register",
    "isLock": false,
    "name": "IP大量请求注册接口",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503317409061
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "login"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "login",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484102697103,
    "endeffect": 1672454699088,
    "modifytime": 1503316979996,
    "score": 0,
    "category": "VISITOR",
    "remark": ">5 in 5m 不需要解析 login",
    "isLock": false,
    "name": "IP大量请求登录接口",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503316979996
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_bytes",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "20"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_distinct_count_page__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "0.1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_cv_cbytes__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一访问"
    ],
    "app": "nebula",
    "starteffect": 1484101695856,
    "endeffect": 1609554496426,
    "modifytime": 1503374673661,
    "score": 0,
    "category": "VISITOR",
    "remark": ">20 ,<4 页面  cbytes_cv < 0.1 in 5m",
    "isLock": false,
    "name": "IP大量请求相似接口",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503374673661
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "sign"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "sign",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484102697103,
    "endeffect": 1672454699088,
    "modifytime": 1503317498863,
    "score": 0,
    "category": "VISITOR",
    "remark": ">5 in 5m 不需要解析 sign",
    "isLock": false,
    "name": "IP大量请求签到接口",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503317498863
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "GET"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "30"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_get_ratio__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484104685827,
    "endeffect": 1672543086878,
    "modifytime": 1503315074348,
    "score": 0,
    "category": "VISITOR",
    "remark": ">30 in 5m",
    "isLock": false,
    "name": "IP大量连续GET请求",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503315074348
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "POST"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "30"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_post_ratio__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484104685827,
    "endeffect": 1672543086878,
    "modifytime": 1503908777232,
    "score": 0,
    "category": "VISITOR",
    "remark": ">30 in 5m",
    "isLock": false,
    "name": "IP大量连续POST请求",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503908777232
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!in",
        "right": {
          "subtype": "",
          "config": {
            "value": "GET,POST"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "20"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "GET,POST",
                "op": "!in",
                "left": "method"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484104685827,
    "endeffect": 1672543086878,
    "modifytime": 1503315379912,
    "score": 0,
    "category": "VISITOR",
    "remark": ">20 in 5m 非GET非POST",
    "isLock": false,
    "name": "IP大量连续其他类型请求",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503315379912
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "T"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "profile",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "20"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_distinct_uid__1h__profile"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "profile",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "一天关联"
    ],
    "app": "nebula",
    "starteffect": 1484046419489,
    "endeffect": 1641121620142,
    "modifytime": 1503904138716,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">20, in 1d",
    "isLock": false,
    "name": "IP当天关联多个用户",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503904138716
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": ".*(attachments|upimg|images|css|uploadfiles|html|uploads|templets|static|template|data|inc|forumdata|upload|includes|cache|avatar).*\\.(php|jsp).*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_stem",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "5分钟内所有满足条件一的访问次数大于10",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "10"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": ".*(attachments|upimg|images|css|uploadfiles|html|uploads|templets|static|template|data|inc|forumdata|upload|includes|cache|avatar).*\\\\.(php|jsp).*",
                "op": "regex",
                "left": "uri_stem"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "IP扫描管理后台地址",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "恶意扫描"
    ],
    "app": "nebula",
    "starteffect": 1472797910264,
    "endeffect": 1630650711288,
    "modifytime": 1503374841090,
    "score": 0,
    "category": "VISITOR",
    "remark": "> 10 in 5m",
    "isLock": false,
    "name": "IP扫描管理后台",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503374841090
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__account_login_distinct_count_uid__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__account_login_distinct_count_password__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503565298398,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 5min",
    "isLock": false,
    "name": "IP换密码请求登录单账号",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503565298398
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "50"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "同UA",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "useragent"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "left": "c_ip",
                "op": "="
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "同页面",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "uri_stem"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "left": "c_ip",
                "op": "="
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1496389151220,
    "endeffect": 1593502751000,
    "modifytime": 1503375522981,
    "score": 0,
    "category": "VISITOR",
    "remark": ">50, 1 页面, 1UA",
    "isLock": false,
    "name": "IP相同UA大量请求单个页面",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503375522981
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__account_login_distinct_count_uid__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__account_login_distinct_count_password__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503565440623,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">3 in 5min",
    "isLock": false,
    "name": "IP相同密码请求登录不同账号",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503565440623
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "访问ip包含.",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "访问url以.asp结尾",
        "op": "endwith",
        "right": {
          "subtype": "",
          "config": {
            "value": ".asp"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_stem",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "状态码为404",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "404"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "status",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "单IP5分钟内访问次数大于5",
        "op": ">=",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "访问.asp文件",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "恶意扫描"
    ],
    "app": "nebula",
    "starteffect": 1479709588319,
    "endeffect": 1572589588503,
    "modifytime": 1503374461363,
    "score": 0,
    "category": "VISITOR",
    "remark": "> 5 动态+静态 ,404 .asp",
    "isLock": false,
    "name": "IP访问.asp文件",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503374461363
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "A",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "A"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "sleep",
          "config": {
            "duration": 5,
            "unit": "m"
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "B",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "B",
                "op": "==",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "跳跃访问"
    ],
    "app": "nebula",
    "starteffect": 1504075128120,
    "endeffect": 1627799928000,
    "modifytime": 1504075245353,
    "score": 0,
    "category": "ACCOUNT",
    "remark": "延迟判断 5m",
    "isLock": false,
    "name": "IP请求A一段时间内没有请求B",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504075245353
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "order_id"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "page"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503633895138,
    "score": 0,
    "category": "ORDER",
    "remark": ">3, <=4页面  in 30min",
    "isLock": false,
    "name": "IP请求下单行为单一",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503633895138
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "请求可疑文件的特征",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": ".*(vhost|bbs|host|wwwroot|www|site|root|hytop|flashfxp|backup|data).*\\.(rar|zip|gz|tar).*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_stem",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "5分钟内所有满足条件一的访问次数大于10",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "10"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": ".*(vhost|bbs|host|wwwroot|www|site|root|hytop|flashfxp|backup|data).*\\\\.(rar|zip|gz|tar).*",
                "op": "regex",
                "left": "uri_stem"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "IP请求可疑文件地址",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "恶意扫描"
    ],
    "app": "nebula",
    "starteffect": 1472800501994,
    "endeffect": 1599203703047,
    "modifytime": 1503374250886,
    "score": 0,
    "category": "VISITOR",
    "remark": "> 10 in 5m",
    "isLock": false,
    "name": "IP请求可疑文件地址",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503374250886
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "HOLDER",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "跳跃访问"
    ],
    "app": "nebula",
    "starteffect": 1504001710079,
    "endeffect": 1627812910000,
    "modifytime": 1504002440025,
    "score": 0,
    "category": "ACCOUNT",
    "remark": "register, no xxx in 5m",
    "isLock": false,
    "name": "IP请求注册前未访问必要资源",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504002440025
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "HOLDER",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "跳跃访问"
    ],
    "app": "nebula",
    "starteffect": 1504001710079,
    "endeffect": 1627812910000,
    "modifytime": 1504002360471,
    "score": 0,
    "category": "ACCOUNT",
    "remark": "login, no xxx in 5m",
    "isLock": false,
    "name": "IP请求登录前未访问必要资源",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504002360471
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "distinct page <=4",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "page"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1503986498910,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 30m, 动态<=4",
    "isLock": false,
    "name": "IP集中请求注册接口",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503986498909
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "page"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503565104097,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 ，页面<=4 in 30min",
    "isLock": false,
    "name": "IP集中请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503565104097
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_distinct_count_page__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "20"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一访问"
    ],
    "app": "nebula",
    "starteffect": 1496373568624,
    "endeffect": 1625023169000,
    "modifytime": 1503374735116,
    "score": 0,
    "category": "VISITOR",
    "remark": ">20 , < 5页面 in 5m",
    "isLock": false,
    "name": "IP集中请求部分接口",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503374735116
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": ".*(iphone|ipod|android|ios|phone|ipad).*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "useragent",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "100"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<",
        "right": {
          "subtype": "",
          "config": {
            "value": "500"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_clicks_avg_timediff__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484101358008,
    "endeffect": 1609554158776,
    "modifytime": 1503376070641,
    "score": 0,
    "category": "VISITOR",
    "remark": ">100, avg < 0.5, in 5m, web",
    "isLock": false,
    "name": "IP页面停留时间过短App",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503376070641
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": ".*(iphone|ipod|android|ios|phone|ipad).*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "useragent",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "100"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_dynamic_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<",
        "right": {
          "subtype": "",
          "config": {
            "value": "800"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "ip__visit_clicks_avg_timediff__5m__rt"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频访问"
    ],
    "app": "nebula",
    "starteffect": 1484101358008,
    "endeffect": 1609554158776,
    "modifytime": 1503375879225,
    "score": 0,
    "category": "VISITOR",
    "remark": ">100, avg < 0.8, in 5m, web",
    "isLock": false,
    "name": "IP页面停留时间过短Web",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503375879225
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "java"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "useragent",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "请求Useragent中包含服务器信息",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "特殊UA"
    ],
    "app": "nebula",
    "starteffect": 1473058630310,
    "endeffect": 1630565831241,
    "modifytime": 1503317687594,
    "score": 0,
    "category": "VISITOR",
    "remark": "java",
    "isLock": false,
    "name": "Java 用户代理",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503317687594
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "python"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "useragent",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "请求Useragent中包含服务器信息",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "特殊UA"
    ],
    "app": "nebula",
    "starteffect": 1473058630310,
    "endeffect": 1630565831241,
    "modifytime": 1503317676324,
    "score": 0,
    "category": "VISITOR",
    "remark": "python",
    "isLock": false,
    "name": "Python 用户代理",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503317676324
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "spider"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "useragent",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "请求Useragent中包含服务器信息",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "特殊UA"
    ],
    "app": "nebula",
    "starteffect": 1473058630310,
    "endeffect": 1630565831241,
    "modifytime": 1503376460453,
    "score": 0,
    "category": "VISITOR",
    "remark": "spider",
    "isLock": false,
    "name": "Spider 用户代理",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503376460453
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "请求IP包含.",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "GET请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "GET"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "目录遍历特征",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "\\.\\.|/etc/passwd|c:\\\\\\\\|cmd\\.exe|\\\\\\\\|/"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_query",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "GET参数中包含目录遍历的特征",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "目录遍历"
    ],
    "app": "nebula",
    "starteffect": 1477984573968,
    "endeffect": 1543389374110,
    "modifytime": 1477984770328,
    "score": 0,
    "category": "VISITOR",
    "remark": "GET参数中包含目录遍历的特征",
    "isLock": false,
    "name": "visit_directory_traversal_get_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477984770328
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "请求IP包含.",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "POST请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "POST"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "目录遍历特征",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "\\.\\.|/etc/passwd|c:\\\\\\\\|cmd\\.exe|\\\\\\\\|/"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_query",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "post参数中包含目录遍历的特征",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "目录遍历"
    ],
    "app": "nebula",
    "starteffect": 1477984830403,
    "endeffect": 1543389630594,
    "modifytime": 1477984883956,
    "score": 0,
    "category": "VISITOR",
    "remark": "POST参数中包含目录遍历的特征",
    "isLock": false,
    "name": "visit_directory_traversal_post_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477984883956
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "ngx_lua_waf策略补充",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "\\.\\./|\\:\\$|\\$\\{|select.+(from|limit)|(?:(union(.*?)select))|having|rongjitest|sleep\\((\\s*)(\\d*)(\\s*)\\)|benchmark\\((.*)\\,(.*)\\)|base64_decode\\(|(?:from\\W+information_schema\\W)|(?:(?:current_)user|database|schema|connection_id)\\s*\\(|(?:etc\\/\\W*passwd)|into(\\s+)+(?:dump|out)file\\s*|group\\s+by.+\\(|xwork.MethodAccessor|(?:define|eval|file_get_contents|include|require|require_once|shell_exec|phpinfo|system|passthru|preg_\\w+|execute|echo|print|print_r|var_dump|(fp)open|alert|showmodaldialog)\\(|xwork\\.MethodAccessor|(gopher|doc|php|glob|file|phar|zlib|ftp|ldap|dict|ogg|data)\\:\\/|java\\.lang|\\$_(GET|post|cookie|files|session|env|phplib|GLOBALS|SERVER)\\[|\\<(iframe|script|body|img|layer|div|meta|style|base|object|input)|(onmouseover|onerror|onload)\\="
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_query",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "GET请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "GET"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "ngx_lua_waf策略补充",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "ngx_lua_waf"
    ],
    "app": "nebula",
    "starteffect": 1477991442997,
    "endeffect": 1511946643357,
    "modifytime": 1477993025291,
    "score": 0,
    "category": "VISITOR",
    "remark": "GET参数中ngx_lua_waf策略补充",
    "isLock": false,
    "name": "visit_ngx_lua_waf_get_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477993025291
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "POST请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "POST"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "ngx_lua_waf策略",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "\\.\\./|\\:\\$|\\$\\{|select.+(from|limit)|(?:(union(.*?)select))|having|rongjitest|sleep\\((\\s*)(\\d*)(\\s*)\\)|benchmark\\((.*)\\,(.*)\\)|base64_decode\\(|(?:from\\W+information_schema\\W)|(?:(?:current_)user|database|schema|connection_id)\\s*\\(|(?:etc\\/\\W*passwd)|into(\\s+)+(?:dump|out)file\\s*|group\\s+by.+\\(|xwork.MethodAccessor|(?:define|eval|file_get_contents|include|require|require_once|shell_exec|phpinfo|system|passthru|preg_\\w+|execute|echo|print|print_r|var_dump|(fp)open|alert|showmodaldialog)\\(|xwork\\.MethodAccessor|(gopher|doc|php|glob|file|phar|zlib|ftp|ldap|dict|ogg|data)\\:\\/|java\\.lang|\\$_(GET|post|cookie|files|session|env|phplib|GLOBALS|SERVER)\\[|\\<(iframe|script|body|img|layer|div|meta|style|base|object|input)|(onmouseover|onerror|onload)\\="
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_body",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "POST参数中ngx_lua_waf策略补充",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "ngx_lua_waf"
    ],
    "app": "nebula",
    "starteffect": 1477993382852,
    "endeffect": 1543398183037,
    "modifytime": 1477993610542,
    "score": 0,
    "category": "VISITOR",
    "remark": "POST参数中ngx_lua_waf策略补充",
    "isLock": false,
    "name": "visit_ngx_lua_waf_post_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477993610542
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "rfi远程文件特征",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "http://|https://|ftp://|php://|sftp://|zlib://|data://|glob://|phar://|file://|gopher://"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_query",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "GET请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "GET"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "GET参数中包含rfi远程文件包含的特征",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "RFI"
    ],
    "app": "nebula",
    "starteffect": 1477972555532,
    "endeffect": 1574481355701,
    "modifytime": 1477972718159,
    "score": 0,
    "category": "VISITOR",
    "remark": "GET参数中包含rfi远程文件包含的特征",
    "isLock": false,
    "name": "visit_rfi_get_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477972718159
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "POST"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "http://|https://|ftp://|php://|sftp://|zlib://|data://|glob://|phar://|file://|gopher://"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_body",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "POST参数中包含rfi远程文件包含的特征",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "RFI"
    ],
    "app": "nebula",
    "starteffect": 1477972735783,
    "endeffect": 1543377535967,
    "modifytime": 1477972805808,
    "score": 0,
    "category": "VISITOR",
    "remark": "POST参数中包含rfi远程文件包含的特征",
    "isLock": false,
    "name": "visit_rfi_post_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477972805808
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "SQL语句特征",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": ".*(\\bselect\\b|\\bunion\\b|\\bupdate\\b|\\bdelete\\b|\\binsert\\b|\\btable\\b|\\bascii\\b|\\bhex\\b|\\bunhex\\b|\\bdrop\\b).*\\bfrom\\b.*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_query",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "GET请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "GET"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "GET参数中的包含SQL语句特征",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "SQL注入"
    ],
    "app": "nebula",
    "starteffect": 1477969816948,
    "endeffect": 1543374617253,
    "modifytime": 1477969994711,
    "score": 0,
    "category": "VISITOR",
    "remark": "GET参数中的包含SQL语句特征",
    "isLock": false,
    "name": "visit_sql_injection_get_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477969994711
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "SQL符号",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "\\\"|/\\*|\\*/|\\||&&|--|;|\\(|\\)|\\'|,|#|@@"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_query",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "GET请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "GET"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "GET请求中包含SQL的符号",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "SQL注入"
    ],
    "app": "nebula",
    "starteffect": 1477971844933,
    "endeffect": 1511667864319,
    "modifytime": 1477971907725,
    "score": 0,
    "category": "VISITOR",
    "remark": "GET请求中包含SQL的符号",
    "isLock": false,
    "name": "visit_sql_injection_hardcore_get_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477971907725
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "POST请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "POST"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "SQL符号",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "\\\"|/\\*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_body",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "post请求中包含sql的符号",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "SQL注入"
    ],
    "app": "nebula",
    "starteffect": 1477971398483,
    "endeffect": 1511926598593,
    "modifytime": 1477971835014,
    "score": 0,
    "category": "VISITOR",
    "remark": "POST请求中包含SQL的符号",
    "isLock": false,
    "name": "visit_sql_injection_post_hardcore_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477971835014
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "SQL语句特征",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": ".*(\\bselect\\b|\\bunion\\b|\\bupdate\\b|\\bdelete\\b|\\binsert\\b|\\btable\\b|\\bascii\\b|\\bhex\\b|\\bunhex\\b|\\bdrop\\b).*\\bfrom\\b.*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_body",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "POST请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "POST"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "POST参数中包含SQL语句特征",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "SQL注入"
    ],
    "app": "nebula",
    "starteffect": 1477970129128,
    "endeffect": 1543029329330,
    "modifytime": 1477970202575,
    "score": 0,
    "category": "VISITOR",
    "remark": "POST参数中包含SQL语句特征",
    "isLock": false,
    "name": "visit_sql_injection_post_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477970202575
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "跨站脚本攻击特征",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": ".*(%3c|%3e|<|>|[|]|~|`).*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_query",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "GET请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "GET"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "GET参数包含跨站脚本攻击特征",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "XSS"
    ],
    "app": "nebula",
    "starteffect": 1477989645897,
    "endeffect": 1542789646124,
    "modifytime": 1477989745580,
    "score": 0,
    "category": "VISITOR",
    "remark": "GET参数包含跨站脚本攻击特征",
    "isLock": false,
    "name": "visit_xss_get_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477989745579
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "POST请求",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "POST"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "method",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "跨站脚本攻击特征",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": ".*(%3c|%3e|<|>|[|]|`).*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_body",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "POST参数包含跨站脚本攻击特征",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "XSS"
    ],
    "app": "nebula",
    "starteffect": 1477989763473,
    "endeffect": 1511944963597,
    "modifytime": 1477989841202,
    "score": 0,
    "category": "VISITOR",
    "remark": "POST参数包含跨站脚本攻击特征",
    "isLock": false,
    "name": "visit_xss_post_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1477989841202
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "IP访问URL参数包含xss攻击特征（攻击字符串包含<script>…..</script>，encode后为%3cscript%3e和%3c%2fscript%3e，即url参数包含正则.*script\\%.*script\\%.*）",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": ".*script.*script.*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uri_query",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "请求疑似xss",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "XSS"
    ],
    "app": "nebula",
    "starteffect": 1472797039443,
    "endeffect": 1630649840283,
    "modifytime": 1472797105454,
    "score": 0,
    "category": "VISITOR",
    "remark": "请求疑似xss",
    "isLock": false,
    "name": "visit_xss_request_ip",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1472797105454
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "regex",
        "right": {
          "subtype": "",
          "config": {
            "value": ".*(feeddemon|indy library|alexa toolbar|asktbfxtv|ahrefsbot|crawldaddy|coolpadwebkit|feedly|universalfeedparser|apachebench|microsoft url control|swiftbot|Zmeu|obot|jaunty|lightdeckreports bot|digext|httpclient|mj12bot|heritrix|easouspider|ezooms|httrack|harvest|audit|dirbuster|pangolin|nmap|sqln|-scan|hydra|parser|libwww|bbbike|sqlmap|w3af|owasp|nikto|fimap|havij|pycurl|zmeu|babykrokodil|netsparker|httperf|bench|SF/).*"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "useragent",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "请求Useragent中包含服务器信息",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "特殊UA"
    ],
    "app": "nebula",
    "starteffect": 1473058630310,
    "endeffect": 1630565831241,
    "modifytime": 1503376597345,
    "score": 0,
    "category": "VISITOR",
    "remark": "apachebench|pycurl, 不包括java|python",
    "isLock": false,
    "name": "服务器用户代理",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503376597345
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "getlocation",
          "config": {
            "source_event_key": "nebula.HTTP_DYNAMIC.c_ip",
            "location_string": [
              "上海市"
            ],
            "location_type": "province",
            "op": "="
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "VISITOR",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 18000
          },
          "type": "func"
        }
      }
    ],
    "tags": [],
    "app": "nebula",
    "starteffect": 1504238467272,
    "endeffect": 1509076867000,
    "modifytime": 1504238527869,
    "score": 0,
    "category": "VISITOR",
    "remark": "地域function测试策略",
    "isLock": false,
    "name": "测试-地域FUNCTION",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504238527869
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "distinct orderid",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "order_id"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "0 paystatus",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "HOLDER",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "下单不支付"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1504094102361,
    "score": 0,
    "category": "ORDER",
    "remark": ">4 in 30min no pay",
    "isLock": false,
    "name": "用户下单不支付",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504094102361
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__account_dynamic_distinct_count_ip__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频关联"
    ],
    "app": "nebula",
    "starteffect": 1484044813003,
    "endeffect": 1641120013785,
    "modifytime": 1503901098133,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 5m",
    "isLock": false,
    "name": "用户关联多个IP",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503901098133
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__account_dynamic_distinct_count_geo_city__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频关联"
    ],
    "app": "nebula",
    "starteffect": 1484045572235,
    "endeffect": 1609584772891,
    "modifytime": 1503900592547,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 in 5m",
    "isLock": false,
    "name": "用户关联多个IP地域",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503900592547
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "contain",
        "right": {
          "subtype": "",
          "config": {
            "value": "."
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "c_ip",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__account_dynamic_distinct_count_did__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频关联"
    ],
    "app": "nebula",
    "starteffect": 1484044813003,
    "endeffect": 1641120013785,
    "modifytime": 1503901374606,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 in 5m",
    "isLock": false,
    "name": "用户关联多个设备",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503901374606
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1504094832686,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 ip in 10m",
    "isLock": false,
    "name": "用户在多个IP请求注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504094832686
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503566234119,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 ip in 10min",
    "isLock": false,
    "name": "用户在多个IP请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503566234119
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "did"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1504095024844,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 ip in 10m",
    "isLock": false,
    "name": "用户在多个设备请求注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504095024844
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "did"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503566297606,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 did in 10min",
    "isLock": false,
    "name": "用户在多个设备请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503566297606
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503634351360,
    "score": 0,
    "category": "ORDER",
    "remark": ">1 ip in 30min",
    "isLock": false,
    "name": "用户多IP请求下单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503634351360
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_CANCEL"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_CANCEL"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_CANCEL"
              ]
            },
            "operand": [
              "order_id"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "取消订单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503906729052,
    "score": 0,
    "category": "ORDER",
    "remark": ">3 in 30min distinct orderid",
    "isLock": false,
    "name": "用户多次取消订单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503906729052
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "F"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "F",
                "op": "==",
                "left": "result"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503566517764,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">3 in 10min T",
    "isLock": false,
    "name": "用户多次登录失败",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503566517764
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "T"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "T",
                "op": "==",
                "left": "result"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503566390905,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">3 in 10min T",
    "isLock": false,
    "name": "用户多次登录成功",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503566390905
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503633559713,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 30min",
    "isLock": false,
    "name": "用户多次请求下单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503633559713
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "product_id"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159294362,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, product_id",
    "isLock": false,
    "name": "用户多次请求下单__不同商品",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159294362
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "merchant"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159405999,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, merchant",
    "isLock": false,
    "name": "用户多次请求下单__不同商户",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159405999
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_detail"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159032547,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, receiver_address_detail",
    "isLock": false,
    "name": "用户多次请求下单__不同地址",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159032547
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_city"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504158956300,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, receiver_address_city ",
    "isLock": false,
    "name": "用户多次请求下单__不同城市",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504158956300
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_mobile"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159501889,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, receiver_mobile",
    "isLock": false,
    "name": "用户多次请求下单__不同手机号",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159501889
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "user_name"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159262177,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, user_name",
    "isLock": false,
    "name": "用户多次请求下单__不同收货人",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159262177
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "order_money_amount"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159569284,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, order_money_amount",
    "isLock": false,
    "name": "用户多次请求下单__不同金额",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159569284
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "product_id"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504075705221,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, product_id",
    "isLock": false,
    "name": "用户多次请求下单__同一商品",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504075705221
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "merchant"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504075681076,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, merchant ",
    "isLock": false,
    "name": "用户多次请求下单__同一商户",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504075681076
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_detail"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504169026541,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, receiver_address_detail",
    "isLock": false,
    "name": "用户多次请求下单__同一地址",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504169026541
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_city"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504151273819,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, receiver_address_city ",
    "isLock": false,
    "name": "用户多次请求下单__同一城市",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504151273819
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_mobile"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504158815830,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, receiver_mobile",
    "isLock": false,
    "name": "用户多次请求下单__同手机号",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504158815830
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "user_name"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504075736601,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, user_name",
    "isLock": false,
    "name": "用户多次请求下单__同收货人",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504075736601
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "金额",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "100"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "order_money_amount",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "次数",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "100",
                "op": "<=",
                "left": "order_money_amount"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504152451257,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, order_money_amount<= 100",
    "isLock": false,
    "name": "用户多次请求下单__金额较低",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504152451257
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "金额",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "100"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "order_money_amount",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "次数",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "100",
                "op": ">",
                "left": "order_money_amount"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159641874,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, order_money_amount > 100",
    "isLock": false,
    "name": "用户多次请求下单__金额较高",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159641874
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1504493674112,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 in 5m",
    "isLock": false,
    "name": "用户多次请求注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504493674112
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503566031055,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">3 in 5min",
    "isLock": false,
    "name": "用户多次请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503566031055
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "did"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503634747252,
    "score": 0,
    "category": "ORDER",
    "remark": ">1 ip in 30min",
    "isLock": false,
    "name": "用户多设备请求下单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503634747252
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "password"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503566595709,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 密码 in 10min",
    "isLock": false,
    "name": "用户换密码登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503566595709
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "time",
          "config": {
            "start": "01:00",
            "end": "06:06"
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "午夜下单"
    ],
    "app": "nebula",
    "starteffect": 1484031286167,
    "endeffect": 1641106486953,
    "modifytime": 1503906575576,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, 0~6",
    "isLock": false,
    "name": "用户深夜多次请求下单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503906575576
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": ">=",
        "right": {
          "subtype": "",
          "config": {
            "value": "2000"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "order_money_amount",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "time",
          "config": {
            "start": "00:00",
            "end": "06:00"
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "午夜下单"
    ],
    "app": "nebula",
    "starteffect": 1484030778584,
    "endeffect": 1609569979438,
    "modifytime": 1503907294060,
    "score": 0,
    "category": "ORDER",
    "remark": ">2,000, 0~6",
    "isLock": false,
    "name": "用户深夜请求下单金额过大",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503907294060
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "登录次数",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "相同密码",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "password"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503566664128,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2, 1密码 in 10min",
    "isLock": false,
    "name": "用户相同密码请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503566664128
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "A",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "A"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "sleep",
          "config": {
            "duration": 5,
            "unit": "m"
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "B",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "B",
                "op": "==",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "跳跃访问"
    ],
    "app": "nebula",
    "starteffect": 1504075128120,
    "endeffect": 1627799928000,
    "modifytime": 1504075287584,
    "score": 0,
    "category": "ACCOUNT",
    "remark": "延迟判断 5m",
    "isLock": false,
    "name": "用户请求A一段时间内没有请求B",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504075287584
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$ "
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "1000"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__order_submit_avg_order_money_amount__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "特殊下单"
    ],
    "app": "nebula",
    "starteffect": 1484031441863,
    "endeffect": 1641020242748,
    "modifytime": 1504161162271,
    "score": 0,
    "category": "ORDER",
    "remark": ">1000 in 5m",
    "isLock": false,
    "name": "用户请求下单__金额较大5m",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504161162271
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "order_id"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "page"
            ],
            "groupby": [
              "uid"
            ],
            "condition": [
              {
                "right": "uid",
                "op": "=",
                "left": "uid"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503634099930,
    "score": 0,
    "category": "ORDER",
    "remark": ">3, <=4页面  in 30min",
    "isLock": false,
    "name": "用户请求下单行为单一",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503634099930
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__order_submit_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__order_distinct_count_receiver_geo_city__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "特殊下单"
    ],
    "app": "nebula",
    "starteffect": 1484034056700,
    "endeffect": 1672472457461,
    "modifytime": 1504161070335,
    "score": 0,
    "category": "ORDER",
    "remark": ">3 order, >1 receiver_geo",
    "isLock": false,
    "name": "用户高频请求下单__不同城市5m",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504161070335
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__order_submit_fail_ratio__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__order_submit_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "特殊下单"
    ],
    "app": "nebula",
    "starteffect": 1484030263640,
    "endeffect": 1672468664362,
    "modifytime": 1504161126876,
    "score": 0,
    "category": "ORDER",
    "remark": ">3 order, F=1 in 5m",
    "isLock": false,
    "name": "用户高频请求下单__全部失败5m",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504161126876
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$ "
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__order_submit_distinct_count_merchant__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__order_submit_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "特殊下单"
    ],
    "app": "nebula",
    "starteffect": 1484037402744,
    "endeffect": 1641026203555,
    "modifytime": 1504075815026,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 5m, merchant",
    "isLock": false,
    "name": "用户高频请求下单__同一商户5m",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504075815026
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_CANCEL"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "uid__order_cancel_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "uid"
              ],
              "event": [
                "nebula",
                "ORDER_CANCEL"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "USER",
            "decision": "review",
            "checkvalue": "uid",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "特殊下单"
    ],
    "app": "nebula",
    "starteffect": 1484035529369,
    "endeffect": 1704528330197,
    "modifytime": 1504161196203,
    "score": 0,
    "category": "ORDER",
    "remark": ">3 cancel in 5m",
    "isLock": false,
    "name": "用户高频请求取消订单5m",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504161196203
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "distinct orderid",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "order_id"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "0 paystatus",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "HOLDER",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "下单不支付"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1504094095324,
    "score": 0,
    "category": "ORDER",
    "remark": ">4 in 30min no pay",
    "isLock": false,
    "name": "设备下单不支付",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504094095324
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "did",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "register_channel"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "register_channel"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "^\\s*$",
                "left": "register_channel",
                "op": "!regex"
              },
              {
                "right": "did",
                "left": "did",
                "op": "="
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "邀请注册"
    ],
    "app": "nebula",
    "starteffect": 1484042007770,
    "endeffect": 1609667608438,
    "modifytime": 1504493976438,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">3 register_count, 1 register_channel in 1h",
    "isLock": false,
    "name": "设备使用相同邀请码注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504493976438
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "did",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_regist_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "register_channel"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "^\\s*$",
                "left": "register_channel",
                "op": "!regex"
              },
              {
                "right": "did",
                "left": "did",
                "op": "="
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "邀请注册"
    ],
    "app": "nebula",
    "starteffect": 1484042007770,
    "endeffect": 1609667608438,
    "modifytime": 1504493965218,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 register_count, same register_channel in 5m",
    "isLock": false,
    "name": "设备使用相同邀请码注册5m",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504493965218
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "did",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_dynamic_distinct_count_ip__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频关联"
    ],
    "app": "nebula",
    "starteffect": 1484046005513,
    "endeffect": 1641121214738,
    "modifytime": 1503900534979,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 5m",
    "isLock": false,
    "name": "设备关联多个IP",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503900534979
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "did",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_dynamic_distinct_count_geo_city__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频关联"
    ],
    "app": "nebula",
    "starteffect": 1484043201651,
    "endeffect": 1672568002539,
    "modifytime": 1503900477309,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 in 5m",
    "isLock": false,
    "name": "设备关联多个IP地域",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503900477309
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "did",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_dynamic_distinct_count_uid__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频关联"
    ],
    "app": "nebula",
    "starteffect": 1484044375482,
    "endeffect": 1641119576127,
    "modifytime": 1503901233001,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 in 5m",
    "isLock": false,
    "name": "设备关联多个用户",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503901233001
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1503474972106,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 ip in 10m",
    "isLock": false,
    "name": "设备在多个IP请求注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503474972106
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503568090144,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5设备 in 5min",
    "isLock": false,
    "name": "设备在多个IP请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503568090144
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503634524815,
    "score": 0,
    "category": "ORDER",
    "remark": ">1 ip in 30min",
    "isLock": false,
    "name": "设备多IP请求下单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503634524815
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1504174259542,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">2 uid in 10m",
    "isLock": false,
    "name": "设备多个用户请求注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504174259542
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_regist_distinct_count_password__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_regist_distinct_count_uid__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042523835,
    "endeffect": 1672480924640,
    "modifytime": 1503475179450,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">3, 1密码 in 5m",
    "isLock": false,
    "name": "设备多次使用相同密码注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503475179450
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_CANCEL"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_CANCEL"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_CANCEL"
              ]
            },
            "operand": [
              "order_id"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "取消订单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503635408385,
    "score": 0,
    "category": "ORDER",
    "remark": ">3 in 30min distinct orderid",
    "isLock": false,
    "name": "设备多次取消订单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503635408385
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "F"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "10"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "F",
                "op": "==",
                "left": "result"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1503386823987,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">10 in 5m",
    "isLock": false,
    "name": "设备多次注册失败",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503386823987
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "T"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "10"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "T",
                "op": "==",
                "left": "result"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1503386864638,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">10 in 5m",
    "isLock": false,
    "name": "设备多次注册成功",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503386864638
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "F"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "F",
                "op": "==",
                "left": "result"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503565592900,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 10min F",
    "isLock": false,
    "name": "设备多次登录失败",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503565592900
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "T"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "result",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 600,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "T",
                "op": "==",
                "left": "result"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503565558496,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 10min T",
    "isLock": false,
    "name": "设备多次登录成功",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503565558496
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503633789746,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 30min ",
    "isLock": false,
    "name": "设备多次请求下单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503633789746
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "product_id"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504160006478,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, product_id",
    "isLock": false,
    "name": "设备多次请求下单__不同商品",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504160006478
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "merchant"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159885999,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, merchant",
    "isLock": false,
    "name": "设备多次请求下单__不同商户",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159885999
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_detail"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504160027095,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, receiver_address_detail",
    "isLock": false,
    "name": "设备多次请求下单__不同地址",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504160027095
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_city"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159910772,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, receiver_address_city ",
    "isLock": false,
    "name": "设备多次请求下单__不同城市",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159910772
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_mobile"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159827274,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, receiver_mobile",
    "isLock": false,
    "name": "设备多次请求下单__不同手机号",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159827274
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "user_name"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504160020591,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, user_name",
    "isLock": false,
    "name": "设备多次请求下单__不同收货人",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504160020591
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "2"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "order_money_amount"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "不同下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159863459,
    "score": 0,
    "category": "ORDER",
    "remark": ">2 in 1h, order_money_amount",
    "isLock": false,
    "name": "设备多次请求下单__不同金额",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159863459
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "product_id"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504155376144,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, product_id",
    "isLock": false,
    "name": "设备多次请求下单__同一商品",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504155376144
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "merchant"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504155424594,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, merchant",
    "isLock": false,
    "name": "设备多次请求下单__同一商户",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504155424594
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "user_name"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504169101871,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, user_name",
    "isLock": false,
    "name": "设备多次请求下单__同一地址",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504169101871
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_address_city"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504155576695,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, receiver_address_city",
    "isLock": false,
    "name": "设备多次请求下单__同一城市",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504155576695
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "receiver_mobile"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504158893635,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, receiver_mobile",
    "isLock": false,
    "name": "设备多次请求下单__同手机号",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504158893635
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "uid",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "user_name"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504155458788,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, user_name",
    "isLock": false,
    "name": "设备多次请求下单__同收货人",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504155458788
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "金额",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "100"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "order_money_amount",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "次数",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "100",
                "op": "<=",
                "left": "order_money_amount"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504155334322,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, order_money_amount<= 100",
    "isLock": false,
    "name": "设备多次请求下单__金额较低",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504155334322
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "金额",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "100"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "order_money_amount",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "次数",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 3600,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              },
              {
                "right": "100",
                "op": ">",
                "left": "order_money_amount"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "单一下单"
    ],
    "app": "nebula",
    "starteffect": 1482826795423,
    "endeffect": 1545898796395,
    "modifytime": 1504159707445,
    "score": 0,
    "category": "ORDER",
    "remark": ">5 in 1h, order_money_amount > 100",
    "isLock": false,
    "name": "设备多次请求下单__金额较高",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504159707445
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "10"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1503386785709,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">10 in 5m",
    "isLock": false,
    "name": "设备多次请求注册",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503386785709
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_login_count__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503565493278,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 5min",
    "isLock": false,
    "name": "设备多次请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503565493278
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503634683609,
    "score": 0,
    "category": "ORDER",
    "remark": ">1 用户 in 30min",
    "isLock": false,
    "name": "设备多用户请求下单",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503634683609
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "uid"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "关联登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503567812814,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5用户 in 5min",
    "isLock": false,
    "name": "设备多用户请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503567812814
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_login_distinct_count_uid__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_login_distinct_count_password__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503565799399,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 5min",
    "isLock": false,
    "name": "设备换密码请求登录单账号",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503565799399
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_login_distinct_count_uid__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "1"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "getvariable",
          "config": {
            "variable": [
              "nebula",
              "did__account_login_distinct_count_password__5m__rt"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            }
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503565858551,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">3 in 5min",
    "isLock": false,
    "name": "设备相同密码请求登录不同账号",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503565858551
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "A",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "A"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "HTTP_DYNAMIC"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "sleep",
          "config": {
            "duration": 5,
            "unit": "m"
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "B",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "HTTP_DYNAMIC"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "B",
                "op": "==",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "跳跃访问"
    ],
    "app": "nebula",
    "starteffect": 1504075128120,
    "endeffect": 1627799928000,
    "modifytime": 1504075297745,
    "score": 0,
    "category": "ACCOUNT",
    "remark": "延迟判断 5m",
    "isLock": false,
    "name": "设备请求A一段时间内没有请求B",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504075297745
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ORDER_SUBMIT"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "3"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ORDER_SUBMIT"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "order_id"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ORDER_SUBMIT"
              ]
            },
            "operand": [
              "page"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ORDER",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 3600
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频下单"
    ],
    "app": "nebula",
    "starteffect": 1502889958243,
    "endeffect": 1564925159000,
    "modifytime": 1503634070945,
    "score": 1,
    "category": "ORDER",
    "remark": ">3, <=4页面  in 30min",
    "isLock": false,
    "name": "设备请求下单行为单一",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503634070945
  },
  {
    "status": "online",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "HOLDER",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "跳跃访问"
    ],
    "app": "nebula",
    "starteffect": 1504001710079,
    "endeffect": 1627812910000,
    "modifytime": 1504002540668,
    "score": 0,
    "category": "ACCOUNT",
    "remark": "register, no xxx in 5m",
    "isLock": false,
    "name": "设备请求注册前未访问必要资源",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504002540668
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "==",
        "right": {
          "subtype": "",
          "config": {
            "value": "0"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 300,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "HOLDER",
                "op": "contain",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "跳跃访问"
    ],
    "app": "nebula",
    "starteffect": 1504001710079,
    "endeffect": 1627812910000,
    "modifytime": 1504002378601,
    "score": 0,
    "category": "ACCOUNT",
    "remark": "login, no xxx in 5m",
    "isLock": false,
    "name": "设备请求登录前未访问必要资源",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504002378601
  },
  {
    "status": "inedit",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ACCOUNT_REGISTRATION"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "distinct page <=4",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "did"
              ],
              "event": [
                "nebula",
                "ACCOUNT_REGISTRATION"
              ]
            },
            "operand": [
              "page"
            ],
            "groupby": [
              "did"
            ],
            "condition": [
              {
                "right": "did",
                "op": "=",
                "left": "did"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "DeviceID",
            "decision": "review",
            "checkvalue": "did",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频注册"
    ],
    "app": "nebula",
    "starteffect": 1484042234738,
    "endeffect": 1641031035299,
    "modifytime": 1504174026989,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 in 30m, 动态<=4",
    "isLock": false,
    "name": "设备集中请求注册接口",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1504174026989
  },
  {
    "status": "online",
    "terms": [
      {
        "scope": "realtime",
        "remark": "",
        "op": "!regex",
        "right": {
          "subtype": "",
          "config": {
            "value": "^\\s*$"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "",
          "config": {
            "field": "page",
            "event": [
              "nebula",
              "ACCOUNT_LOGIN"
            ]
          },
          "type": "event"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": ">",
        "right": {
          "subtype": "",
          "config": {
            "value": "5"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "count",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "ACCOUNT_LOGIN"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "c_ip"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              },
              {
                "right": "^\\s*$",
                "op": "!regex",
                "left": "page"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "<=",
        "right": {
          "subtype": "",
          "config": {
            "value": "4"
          },
          "type": "constant"
        },
        "left": {
          "subtype": "count",
          "config": {
            "algorithm": "distinct",
            "interval": 1800,
            "sourceevent": [
              "nebula",
              "HTTP_DYNAMIC"
            ],
            "trigger": {
              "keys": [
                "c_ip"
              ],
              "event": [
                "nebula",
                "ACCOUNT_LOGIN"
              ]
            },
            "operand": [
              "page"
            ],
            "groupby": [
              "c_ip"
            ],
            "condition": [
              {
                "right": "c_ip",
                "op": "=",
                "left": "c_ip"
              }
            ]
          },
          "type": "func"
        }
      },
      {
        "scope": "realtime",
        "remark": "",
        "op": "",
        "right": null,
        "left": {
          "subtype": "setblacklist",
          "config": {
            "remark": "",
            "name": "ACCOUNT",
            "checktype": "IP",
            "decision": "review",
            "checkvalue": "c_ip",
            "checkpoints": "",
            "ttl": 300
          },
          "type": "func"
        }
      }
    ],
    "tags": [
      "高频登录"
    ],
    "app": "nebula",
    "starteffect": 1484040852259,
    "endeffect": 1641116053528,
    "modifytime": 1503565737736,
    "score": 0,
    "category": "ACCOUNT",
    "remark": ">5 ，页面<=4 in 30min",
    "isLock": false,
    "name": "设备集中请求登录",
    "version": 1511502813322,
    "group_id": 2,
    "createtime": 1503565737736
  }
]